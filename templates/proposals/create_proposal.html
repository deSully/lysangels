{% extends 'base.html' %}

{% block title %}Cr√©er une proposition - LysAngels{% endblock %}

{% block content %}
<div class="min-h-screen bg-lily-cream py-8">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-6">
            <a href="{% url 'proposals:request_detail' proposal_request.id %}"
               class="text-lily-purple hover:text-opacity-80 font-medium inline-flex items-center mb-4">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Retour √† la demande
            </a>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Formulaire principal -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <div class="mb-8">
                        <h1 class="text-3xl font-bold text-lily-dark mb-2">
                            Cr√©er votre proposition
                        </h1>
                        <p class="text-gray-600">
                            Envoyez une proposition d√©taill√©e et personnalis√©e pour ce projet
                        </p>
                    </div>

                    <form method="post" enctype="multipart/form-data" class="space-y-6">
                        {% csrf_token %}

                        <!-- Titre de la proposition -->
                        <div>
                            <label for="title" class="block text-sm font-medium text-gray-700 mb-2">
                                Titre de la proposition *
                            </label>
                            <input type="text" name="title" id="title" required
                                   placeholder="Ex: Forfait Premium Mariage - Photo & Vid√©o"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition">
                            <p class="text-sm text-gray-500 mt-1">
                                Un titre accrocheur qui r√©sume votre offre
                            </p>
                        </div>

                        <!-- Message d'introduction -->
                        <div>
                            <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
                                Message personnalis√© *
                            </label>
                            <textarea name="message" id="message" rows="4" required
                                      placeholder="Pr√©sentez-vous et expliquez pourquoi vous √™tes le bon choix pour ce projet..."
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition"></textarea>
                            <p class="text-sm text-gray-500 mt-1">
                                üí° Montrez que vous avez compris les besoins du client
                            </p>
                        </div>

                        <!-- Description d√©taill√©e -->
                        <div>
                            <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
                                Description des services propos√©s *
                            </label>
                            <textarea name="description" id="description" rows="8" required
                                      placeholder="D√©taillez les services inclus, le d√©roulement, le mat√©riel utilis√©, les livrables, etc."
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition"></textarea>
                            <p class="text-sm text-gray-500 mt-1">
                                Soyez le plus pr√©cis possible sur ce qui est inclus dans votre offre
                            </p>
                        </div>

                        <!-- Tarification -->
                        <div class="bg-lily-cream rounded-xl p-6 space-y-4">
                            <h3 class="font-medium text-gray-900 mb-4">Tarification</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="price" class="block text-sm font-medium text-gray-700 mb-2">
                                        Prix total (FCFA) *
                                    </label>
                                    <input type="number" name="price" id="price" required min="0" step="1000"
                                           placeholder="150000"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition">
                                </div>

                                <div>
                                    <label for="deposit_required" class="block text-sm font-medium text-gray-700 mb-2">
                                        Acompte requis (FCFA)
                                    </label>
                                    <input type="number" name="deposit_required" id="deposit_required" min="0" step="1000"
                                           placeholder="50000"
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition">
                                    <p class="text-sm text-gray-500 mt-1">Optionnel</p>
                                </div>
                            </div>

                            <div>
                                <label for="validity_days" class="block text-sm font-medium text-gray-700 mb-2">
                                    Validit√© de la proposition (jours)
                                </label>
                                <input type="number" name="validity_days" id="validity_days" value="30" min="1"
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition">
                                <p class="text-sm text-gray-500 mt-1">
                                    Nombre de jours pendant lesquels cette offre reste valable
                                </p>
                            </div>
                        </div>

                        <!-- Conditions g√©n√©rales -->
                        <div>
                            <label for="terms_and_conditions" class="block text-sm font-medium text-gray-700 mb-2">
                                Conditions g√©n√©rales et modalit√©s
                            </label>
                            <textarea name="terms_and_conditions" id="terms_and_conditions" rows="6"
                                      placeholder="Exemple:&#10;- Acompte de 30% √† la signature&#10;- Solde √† r√©gler 48h avant l'√©v√©nement&#10;- Annulation possible jusqu'√† 15 jours avant (remboursement 50%)&#10;- Dur√©e de la prestation: 8 heures&#10;- Livraison des photos retouch√©es sous 15 jours..."
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition"></textarea>
                            <p class="text-sm text-gray-500 mt-1">
                                Modalit√©s de paiement, conditions d'annulation, d√©lais de livraison, etc.
                            </p>
                        </div>

                        <!-- Pi√®ce jointe -->
                        <div>
                            <label for="attachment" class="block text-sm font-medium text-gray-700 mb-2">
                                Devis d√©taill√© ou document compl√©mentaire
                            </label>
                            <input type="file" name="attachment" id="attachment"
                                   accept=".pdf,.doc,.docx,.jpg,.jpeg,.png"
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-lily-purple focus:border-transparent transition">
                            <p class="text-sm text-gray-500 mt-1">
                                PDF, Word ou image (optionnel) - Max 5 Mo
                            </p>
                        </div>

                        <!-- Actions -->
                        <div class="flex items-center justify-between pt-6 border-t border-gray-200">
                            <a href="{% url 'proposals:request_detail' proposal_request.id %}"
                               class="text-gray-600 hover:text-lily-purple transition">
                                Annuler
                            </a>
                            <button type="submit"
                                    class="bg-lily-purple text-white px-8 py-3 rounded-lg font-medium hover:bg-opacity-90 transition transform hover:scale-105 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                </svg>
                                Envoyer la proposition
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Sidebar - R√©sum√© de la demande -->
            <div class="space-y-6">
                <!-- Info demande -->
                <div class="bg-white rounded-xl shadow-sm p-6 sticky top-24">
                    <h3 class="font-medium text-gray-900 mb-4">R√©sum√© de la demande</h3>
                    
                    <div class="space-y-3 text-sm">
                        <div>
                            <span class="text-gray-600">Projet</span>
                            <p class="font-medium text-lily-dark">{{ proposal_request.project.title }}</p>
                        </div>

                        <div>
                            <span class="text-gray-600">Type</span>
                            <p class="font-medium text-lily-dark">{{ proposal_request.project.event_type.name }}</p>
                        </div>

                        <div>
                            <span class="text-gray-600">Date</span>
                            <p class="font-medium text-lily-dark">
                                {{ proposal_request.project.event_date|date:"d/m/Y" }}
                            </p>
                        </div>

                        <div>
                            <span class="text-gray-600">Lieu</span>
                            <p class="font-medium text-lily-dark">{{ proposal_request.project.city }}</p>
                        </div>

                        <div>
                            <span class="text-gray-600">Budget client</span>
                            <p class="font-medium text-lily-purple">
                                {{ proposal_request.project.budget_min|floatformat:0 }}
                                {% if proposal_request.project.budget_max %}
                                    - {{ proposal_request.project.budget_max|floatformat:0 }}
                                {% endif %}
                                FCFA
                            </p>
                        </div>

                        {% if proposal_request.project.guest_count %}
                            <div>
                                <span class="text-gray-600">Invit√©s</span>
                                <p class="font-medium text-lily-dark">{{ proposal_request.project.guest_count }}</p>
                            </div>
                        {% endif %}
                    </div>

                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <a href="{% url 'proposals:request_detail' proposal_request.id %}"
                           class="text-lily-purple hover:text-opacity-80 font-medium text-sm transition flex items-center">
                            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                            </svg>
                            Voir tous les d√©tails
                        </a>
                    </div>
                </div>

                <!-- Conseils -->
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <div class="flex items-start">
                        <svg class="w-6 h-6 text-blue-600 mr-3 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <h4 class="font-medium text-blue-900 mb-2">Conseils pour une bonne proposition</h4>
                            <ul class="text-sm text-blue-800 space-y-2">
                                <li class="flex items-start">
                                    <span class="mr-2">‚Ä¢</span>
                                    <span>Personnalisez votre message en r√©f√©ren√ßant des d√©tails du projet</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">‚Ä¢</span>
                                    <span>Soyez transparent sur ce qui est inclus et exclu</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">‚Ä¢</span>
                                    <span>Proposez des tarifs comp√©titifs mais justes</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">‚Ä¢</span>
                                    <span>Pr√©cisez vos conditions de paiement et d'annulation</span>
                                </li>
                                <li class="flex items-start">
                                    <span class="mr-2">‚Ä¢</span>
                                    <span>Joignez un devis PDF professionnel si possible</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
